<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ HYPER-SPEED MASTERY CONTROL</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
            min-height: 100vh;
            padding: 20px;
        }
        
        .container { max-width: 1400px; margin: 0 auto; }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        
        .control-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .control-card h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
            margin: 5px 0;
        }
        
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .btn.primary {
            background: linear-gradient(45deg, #00d2ff, #3a7bd5);
            font-size: 1.2rem;
            padding: 15px 30px;
        }
        
        .btn.success {
            background: linear-gradient(45deg, #56ab2f, #a8e6cf);
        }
        
        .btn.warning {
            background: linear-gradient(45deg, #f093fb, #f5576c);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #00d2ff;
        }
        
        .stat-label {
            font-size: 1rem;
            opacity: 0.8;
        }
        
        .progress-section {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #56ab2f, #a8e6cf);
            border-radius: 10px;
            transition: width 1s ease;
            position: relative;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .provider-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .provider-badge {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .provider-badge.active {
            border-color: #00d2ff;
            background: rgba(0,210,255,0.2);
        }
        
        .provider-badge.fast {
            border-color: #56ab2f;
            background: rgba(86,171,47,0.2);
        }
        
        .log {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 5px;
            border-radius: 5px;
        }
        
        .log-entry.success { background: rgba(86,171,47,0.2); }
        .log-entry.error { background: rgba(255,107,107,0.2); }
        .log-entry.info { background: rgba(0,210,255,0.2); }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .hidden { display: none; }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ HYPER-SPEED MASTERY CONTROL</h1>
            <p>Parallel AI Provider Orchestration for Ultra-Fast Training</p>
        </div>
        
        <div class="controls">
                <div class="control-card">
                    <h3>üî• Accelerate Mastery</h3>
                    <p>ASAP mode: Gain new capabilities at maximum speed using all providers.</p>
                    <button class="btn primary" id="asapBtn" onclick="engageASAPMode()">
                        ACCELERATE NOW
                    </button>
                </div>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="avgMastery">--</div>
                <div class="stat-label">Average Mastery</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="providersActive">--</div>
                <div class="stat-label">Active Providers</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="speedup">--</div>
                <div class="stat-label">Current Speedup</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="consensus">--</div>
                <div class="stat-label">Consensus Rate</div>
            </div>
        </div>
        
        <div class="progress-section">
            <h3>üéØ Mastery Progress</h3>
            <div id="domainProgress"></div>
        </div>
        
        <div class="control-card">
            <h3>ü§ñ Provider Status</h3>
            <div class="provider-grid" id="providerGrid"></div>
        </div>
        
        <div class="control-card">
            <h3>üìù Training Log</h3>
            <div class="log" id="trainingLog"></div>
        </div>
    </div>

    <script>
            let updateInterval;
            let isASAPMode = false;

            async function engageASAPMode() {
                const btn = document.getElementById('asapBtn');
                btn.innerHTML = '<span class="loading"></span> ACCELERATING...';
                btn.disabled = true;

                logMessage('üî• ASAP mode: Accelerating capability gain...', 'info');

                try {
                    const response = await fetch('/api/v1/training/hyper-speed/start', {
                        method: 'POST'
                    });
                    const result = await response.json();

                    if (result.ok) {
                        logMessage('‚úÖ ASAP mode complete: ' + result.message, 'success');
                        logMessage(`üìä Summary: ${JSON.stringify(result.summary?.efficiency || {})}`, 'info');
                        isASAPMode = true;
                        startRealTimeUpdates();
                    } else {
                        logMessage('‚ùå ASAP mode failed: ' + result.error, 'error');
                    }
                } catch (error) {
                    logMessage('‚ùå Error: ' + error.message, 'error');
                }

                btn.innerHTML = 'ACCELERATE NOW';
                btn.disabled = false;
            }

            async function refreshStats() {
                try {
                    // Get hyper-speed stats
                    const hyperResponse = await fetch('/api/v1/training/hyper-speed/stats');
                    const hyperData = await hyperResponse.json();

                    // Get regular training overview
                    const overviewResponse = await fetch('/api/v1/training/overview');
                    const overviewData = await overviewResponse.json();

                    // Get provider status
                    const providerResponse = await fetch('/api/v1/providers/status');
                    const providerData = await providerResponse.json();

                    updateUI(hyperData, overviewData, providerData);

                } catch (error) {
                    logMessage('‚ùå Stats refresh failed: ' + error.message, 'error');
                }
            }
        
        function updateUI(hyperData, overviewData, providerData) {
            // Update main stats
            const domains = overviewData.data?.domains || [];
            const avgMastery = domains.length ? 
                domains.reduce((sum, d) => sum + (d.mastery || 0), 0) / domains.length : 0;
            
            document.getElementById('avgMastery').textContent = Math.round(avgMastery) + '%';
            document.getElementById('providersActive').textContent = 
                hyperData.hyperStats?.providersActive?.length || 0;
            document.getElementById('speedup').textContent = 
                (hyperData.hyperStats?.currentSpeedup || 1).toFixed(1) + 'x';
            document.getElementById('consensus').textContent = 
                Math.round((hyperData.hyperStats?.consensusAchieved / 
                           Math.max(1, hyperData.hyperStats?.questionsProcessed)) * 100) + '%';
            
            // Update domain progress
            updateDomainProgress(domains);
            
            // Update provider grid
            updateProviderGrid(providerData.status, hyperData.hyperStats?.providersActive || []);
        }
        
        function updateDomainProgress(domains) {
            const container = document.getElementById('domainProgress');
            container.innerHTML = '';
            
            domains.forEach(domain => {
                const domainDiv = document.createElement('div');
                domainDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>${domain.emoji || 'üìö'} ${domain.name}</span>
                        <span>${Math.round(domain.mastery || 0)}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${domain.mastery || 0}%"></div>
                    </div>
                `;
                container.appendChild(domainDiv);
            });
        }
        
        function updateProviderGrid(providerStatus, activeProviders) {
            const container = document.getElementById('providerGrid');
            container.innerHTML = '';
            
            Object.entries(providerStatus || {}).forEach(([provider, status]) => {
                const isActive = activeProviders.includes(provider);
                const badge = document.createElement('div');
                badge.className = `provider-badge ${isActive ? 'active' : ''} ${status.available ? 'fast' : ''}`;
                badge.innerHTML = `
                    <div style="font-weight: bold;">${provider}</div>
                    <div style="font-size: 0.8rem; opacity: 0.8;">
                        ${status.available ? '‚úÖ Ready' : '‚ùå Offline'}
                    </div>
                `;
                container.appendChild(badge);
            });
        }
        
        function logMessage(message, type = 'info') {
            const log = document.getElementById('trainingLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }
        
        function startRealTimeUpdates() {
            if (updateInterval) clearInterval(updateInterval);
            updateInterval = setInterval(refreshStats, 5000); // Every 5 seconds
        }
        
        // Initialize
        window.onload = function() {
              logMessage('üöÄ ASAP Mode: Ready to accelerate mastery', 'success');
              refreshStats();
              // Optionally auto-engage ASAP mode on load:
              // engageASAPMode();
        };
        
        // Cleanup
        window.onbeforeunload = function() {
            if (updateInterval) clearInterval(updateInterval);
        };
    </script>
</body>
</html>