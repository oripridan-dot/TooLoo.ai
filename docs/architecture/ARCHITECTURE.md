# TooLoo.ai V3 Architecture

> **@intent** This document provides a visual and textual overview of the TooLoo.ai
> codebase architecture, automatically generated from the actual dependency graph.

*Last generated: 2025-12-01*

## Visual Dependency Graph

![Dependency Graph](./dependency-graph.svg)

> If the image doesn't render, install Graphviz and re-run `npm run generate:arch`

## Architecture Overview

```mermaid
graph TD
    subgraph "Cognitive Layer"
        Cortex[üß† Cortex<br/>Intent & Context]
        Precog[üîÆ Precog<br/>Model Routing]
    end

    subgraph "Infrastructure Layer"
        Nexus[üåê Nexus<br/>API & Events]
        Core[‚öôÔ∏è Core<br/>Shared Utilities]
    end

    subgraph "Quality Layer"
        QA[üõ°Ô∏è QA<br/>Guardian System]
    end

    subgraph "Shared"
        Shared[üì¶ Shared<br/>EventBus & Registry]
    end

    Cortex --> Precog
    Cortex --> Shared
    Precog --> Shared
    Nexus --> Cortex
    Nexus --> Precog
    Nexus --> Shared
    QA --> Shared
    Core --> Shared
```

## Module Summary

| Module | Files | Outgoing Dependencies |
|--------|-------|----------------------|
| `@google` | 1 | 0 |
| `axios` | 1 | 0 |
| `better-sqlite3` | 1 | 0 |
| `body-parser` | 1 | 0 |
| `cheerio` | 1 | 0 |
| `chokidar` | 1 | 0 |
| `cli` | 5 | 16 |
| `commander` | 1 | 0 |
| `core` | 14 | 30 |
| `cors` | 1 | 0 |
| `cortex` | 38 | 131 |
| `dotenv` | 2 | 0 |
| `express` | 1 | 0 |
| `fs-extra` | 1 | 0 |
| `glob` | 1 | 0 |
| `js-yaml` | 1 | 0 |
| `main.ts` | 1 | 12 |
| `multer` | 1 | 0 |
| `nexus` | 29 | 136 |
| `node-fetch` | 1 | 0 |
| `openai` | 1 | 0 |
| `playwright` | 1 | 0 |
| `precog` | 23 | 69 |
| `promises` | 1 | 0 |
| `qa` | 13 | 62 |
| `root` | 11 | 0 |
| `shared` | 4 | 6 |
| `sharp` | 1 | 0 |
| `socket.io` | 1 | 0 |
| `typescript` | 1 | 0 |
| `uuid` | 1 | 0 |
| `zod` | 1 | 0 |


## Module Responsibilities

| Module | Role | Key Components |
|--------|------|----------------|
| **Cortex** | The "Manager" | Intent detection, Memory, Planning, Motor control |
| **Precog** | The "Strategist" | Model routing, Training data, Synthesis |
| **Nexus** | The "Backbone" | API server, WebSocket, Routes, Versioning |
| **Core** | Shared Utilities | Config, Module Registry, Architecture Analyzer |
| **Shared** | Communication | EventBus, System Info |
| **QA** | Quality Guardian | Hygiene checks, Wiring verification |

## Dependency Rules

1. **No Circular Dependencies** - Modules must not create circular imports
2. **Shared is Leaf** - `@shared/*` should only be imported, never import from other modules
3. **Layered Access** - Higher layers (Cortex, Precog) can import from lower (Nexus, Core)

## Violations Report

‚ö†Ô∏è **3 violations detected** - See `dependency-graph.json` for details

---

*Generated by `scripts/generate-arch-graph.ts`*
